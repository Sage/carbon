import { Meta, ArgTypes, Canvas } from "@storybook/blocks";

import * as TabStories from "./tab/tab.stories";
import * as TabsStories from "./tabs.stories";

import DeprecationWarning from "../../../.storybook/utils/deprecation-warning.component";

<Meta of={TabsStories} />

# Tabs

<DeprecationWarning>
  This version of the Tabs component is no longer supported and will be removed
  in a future release. Please consider moving to the{" "}
  <a style={{ color: "white" }} href="../?path=/docs/tabs--docs">
    {" "}
    newer implementation
  </a>{" "}
  as soon as possible.
</DeprecationWarning>

<a
  target="_blank"
  href="https://zeroheight.com/2ccf2b601/p/54468c-tab"
  style={{ color: "#007E45", fontWeight: "bold", textDecoration: "underline" }}
  rel="noreferrer"
>
  Product Design System component
</a>

Switch between content panes or filtered views of tables.

## Contents

- [Quick Start](#quick-start)
- [Examples](#examples)
- [Validation states](#validation-states)
- [Props](#props)

## Quick Start

```javascript
import { Tabs, Tab } from "carbon-react/lib/components/tabs";
```

- Navigating the hierarchy of the app? [Try Menu](../?path=/docs/menu--docs)
- Positioning your primary navigation? [Try Navigation Bar](../?path=/docs/navigation-bar--docs)

- Switch between variants of a page or different tables (e.g. separate tables showing unread and read emails).
- There are two `position` options:
  - `top` - shows the tabs in a line, typically above a Table - best for short lists of tabs.
  - `left` - show the tables in a column, typically to the left of a Table - best for longer lists of tabs.
- You can also `align` the tabs `left` or `right`. This configuration:
  - sets the text alignment for `left` tabs.
  - sets `left` or `right` page position for `top` tabs.
- Only use tabs if thereâ€™s more than one, and show the content of one tab by default. Avoid multiple rows of tabs,
  nested tabs, or using vertical and horizontal tabs at the same time.
- To use `Tabs` with a routing library see our documentation on this here: [Usage with routing](../?path=/docs/documentation-usage-with-routing--docs).

## Examples

### Default

The tabs widget also allows you to select a tab on page load. By default this is set to the first tab.

<Canvas of={TabsStories.DefaultStory} />

### Focusing a Tab Programmatically

```javascript
import { TabsHandle } from "carbon-react/lib/components/tabs";
```

The `TabsHandle` type provides an imperative handle for programmatic control over a desired `Tab`.
Using a ref, you can access its `focusTab()` method which accepts a `tabId` parameter.
Pass the same ID that you've assigned to the `tabId` prop on the `Tab` you want to focus.

<Canvas of={TabsStories.ProgrammaticFocus} />

### Positioned top and aligned right

<Canvas of={TabsStories.PositionedTopAlignedRight} />

### Positioned left and aligned left

<Canvas of={TabsStories.PositionedLeftAndAlignedLeft} />

### Positioned left and aligned right

<Canvas of={TabsStories.PositionedLeftAndAlignedRight} />

### With Link as a Tab

<Canvas of={TabsStories.WithLinkAsATab} />

### With specified tab visible

To set a different tab on page load pass a `tabId` to the `selectedTabId` prop as shown in the example below.

<Canvas of={TabsStories.WithSpecifiedTabVisible} />

### Without extended dividing line

By setting the `extendedLine` prop to "false" it is possible to trim the excess line from the `TabHeading`, by default this
is set to "true".

<Canvas of={TabsStories.WithoutExtendedDividingLine} />

### Large tabs

The `size` prop can be used to set the `TabTitle` to either "default" or "large".

#### Positioned top

<Canvas of={TabsStories.WithLargeTabsPositionedTop} />

#### Positioned left

<Canvas of={TabsStories.WithLargeTabsPositionedLeft} />

### With borders

The `borders` prop can be used to add a combination of borders to the `TabTitle`. The prop accepts one of the following values:
"off" (default), "on", "no left side", "no right side" and "no sides".

#### Positioned top, borders on

<Canvas of={TabsStories.WithBordersPositionedTop} />

#### Positioned top, borders with no sides

<Canvas of={TabsStories.WithNoSidesPositionedTop} />

#### Positioned left, borders on

<Canvas of={TabsStories.WithBordersPositionedLeft} />

#### Positioned left, borders with no sides

<Canvas of={TabsStories.WithNoSidesPositionedLeft} />

### With additional title siblings

It is possible to add additional elements to the a TabTitle by using the `siblings` prop. The `titlePosition` prop
can be used to render the `title` "before" (default) or "after" the additional elements.

<Canvas of={TabsStories.WithAdditionalTitleSiblings} />

#### Large tabs with siblings

<Canvas of={TabsStories.WithAdditionalTitleSiblingsSizeLarge} />

### With custom layout

It is possible to override the static layout of the `TabTitle` by passing in your own custom layouts to the `customLayout`
prop to the `Tab` component.

<Canvas of={TabsStories.WithCustomLayout} />

### With alternate styling

By setting the `variant` prop to "alternate" it is possible to apply some additional styling variants as seen below.

<Canvas of={TabsStories.WithAlternateStyling} />

### With headerWidth

The `headerWidth` prop works only if prop `position` is set to `left`.

<Canvas of={TabsStories.WithHeaderWidth} />

### With custom spacing

The `Tabs`component also allows you to pass custom margin spacing, whilst `Tab` components support custom padding spacings.
The spacing modifiers support being passed either a number between 1 and 8 that is then multiplied by `8px` or any valid
CSS string.

<Canvas of={TabsStories.WithCustomSpacing} />

### Responsive

#### Horizontal

**Note: This story is best viewed in the `canvas` view and by adjusting the size of the window.**

The `Tabs` component is responsive and will display navigation buttons to the left and right when the following conditions are met:

- The `position` prop is set to `top`;
- There are more tabs than can fit in the available space.

When both conditions are met, the `Tabs` component will display navigation buttons to the left and right of the tabs. Clicking on
these buttons will scroll the tabs in the respective direction. If there are no tabs to scroll to in a given direction, then the
respective navigation button will not appear.

<Canvas of={TabsStories.Responsive} />

#### Vertical

**Note: This story is best viewed in the `canvas` view and by adjusting the size of the window.**

The `Tabs` component is also responsive when oriented vertically. Please note that the navigation buttons described above will not appear
when the `position` prop is set to `left`.

<Canvas of={TabsStories.ResponsiveVertical} />

### Integrating with an external history

It is possible to integrate the `Tabs` component with an external `history` to manipulate the location when a given `Tab`
is selected. In order to achieve this you should use the `onTabChange` prop to pass a callback that calls `push` or `replace`
on the provided `history`. The `selectedTabId` prop can also be used to update which tab is selected. Below is an example
implementation using `createHashHistory` from `history@v5.0.0`.

```jsx
import React, { useState, useEffect } from "react";
import { Tabs, Tab } from "carbon-react/lib/components/tabs";
import { createHashHistory } from "history";

const tabIds = ["tab-1", "tab-2", "tab-3"];

const TabsWithExternalHashHistory = ({ history, children, ...rest }) => {
  const { pathname } = history?.location;
  const initialActiveTab = tabIds.includes(pathname) ? pathname : tabIds[0];
  const [activeTab, setActiveTab] = useState(initialActiveTab);

  useEffect(() => {
    const stopListen = history.listen(({ action, location }) => {
      if (action === "POP" && !tabIds.includes(location?.pathname)) {
        // back pressed and no id available from pathname
        setActiveTab(tabIds[0]);
      } else if (tabIds.includes(location?.pathname)) {
        const index = tabIds.findIndex((id) => location?.pathname === id);
        const tabId = tabIds[index];

        if (tabId && tabId !== activeTab) {
          setActiveTab(tabId);
        }
      }
    });

    return () => stopListen();
  }, [activeTab, history]);

  const handleTabChange = (tabid) => history.push(tabid);

  return (
    <Tabs {...rest} onTabChange={handleTabChange} selectedTabId={activeTab}>
      {children}
    </Tabs>
  );
};

const App = () => {
  const history = createHashHistory();
  return (
    <TabsWithExternalHashHistory history={history} align="left" position="top">
      <Tab tabId="tab-1" title="Tab 1" key="tab-1">
        Content for tab 1
      </Tab>
      <Tab tabId="tab-2" title="Tab 2" key="tab-2">
        Content for tab 2
      </Tab>
      <Tab tabId="tab-3" title="Tab 3" key="tab-3">
        Content for tab 3
      </Tab>
    </TabsWithExternalHashHistory>
  );
};
```

## Validation States

If some input-based Carbon component within a `Tab` is in an error or warning state, the `Tab` will also render with the same state - showing a visual,
coloured outline and icon to signify it contains an invalid input field the user needs to address.
You can also use the `errorMessage` and/or `warningMessage` props on the `Tab` component to set a descriptive message for assistive technology users when the `Tab` is in an error or warning state.

See our [Validations](../?path=/docs/documentation-validations--docs) documentation page for more information about input validation.

<Canvas of={TabsStories.WithValidationState} />

## Props

### Tabs

<ArgTypes of={TabsStories} />

### Tab

<ArgTypes of={TabStories} />
