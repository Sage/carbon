import { Meta, Props, Preview, Story } from "@storybook/addon-docs/blocks";
import { action } from "@storybook/addon-actions";
import { useState, useRef } from "react";
import { Select, Option, OptionGroupHeader } from "../";
import Button from "../../button";
import SelectTextbox from "../select-textbox/select-textbox.component";
import StyledSystemProps from "../../../../.storybook/utils/styled-system-props";

<Meta title="Design System/Select" parameters={{ info: { disable: true } }} />

# Simple Select

Select one of available options from the drop-down menu

## Overview

Simple Select is a Carbon styled equivalent of HTML Select Element.

## Guidance, hints and tips

Always insert `Option` Components inside the `Select`, analogous to the original `<select>` and `<option>` HTML Elements.

## Quick Start

To use the `Select` component you have to import two components: `<Select />` and `<Option />`
from `carbon-react/lib/components/select`.

```javascript
import { Select, Option } from "carbon-react/lib/components/select";
```

### Basic usage:

<Preview>
  <Story name="basic">
    <Select
      name="simple"
      id="simple"
      label="label"
      labelInline
      onOpen={action("onOpen")}
      onChange={action("onChange", { depth: 2 })}
      onClick={action("onClick", { depth: 2 })}
      onFocus={action("onFocus", { depth: 2 })}
      onBlur={action("onBlur", { depth: 2 })}
      onKeyDown={action("onKeyDown", { depth: 2 })}
    >
      <Option text="Amber" value="1" />
      <Option text="Black" value="2" />
      <Option text="Blue" value="3" />
      <Option text="Brown" value="4" />
      <Option text="Green" value="5" />
      <Option text="Orange" value="6" />
      <Option text="Pink" value="7" />
      <Option text="Purple" value="8" />
      <Option text="Red" value="9" />
      <Option text="White" value="10" />
      <Option text="Yellow" value="11" />
    </Select>
  </Story>
</Preview>

### Required

You can use the `required` prop to indicate if the field is mandatory.

<Preview>
  <Story name="required">
    <Select
      name="required-select"
      id="required-select"
      label="Foreground Color"
      required
    >
      <Option text="Amber" value="1" />
      <Option text="Black" value="2" />
      <Option text="Blue" value="3" />
      <Option text="Brown" value="4" />
      <Option text="Green" value="5" />
      <Option text="Orange" value="6" />
      <Option text="Pink" value="7" />
      <Option text="Purple" value="8" />
      <Option text="Red" value="9" />
      <Option text="White" value="10" />
      <Option text="Yellow" value="11" />
    </Select>
  </Story>
</Preview>

### Controlled usage:

<Preview>
  <Story name="controlled" parameters={{ chromatic: { disable: true } }}>
    {() => {
      const [value, setValue] = useState("");
      function onChangeHandler(event) {
        setValue(event.target.value);
        action("value set");
      }
      function clearValue() {
        setValue("");
      }
      return (
        <div>
          <Button onClick={clearValue} mb={2}>
            clear
          </Button>
          <Select
            id="controlled"
            name="controlled"
            value={value}
            onChange={onChangeHandler}
          >
            <Option text="Amber" value="1" />
            <Option text="Black" value="2" />
            <Option text="Blue" value="3" />
            <Option text="Brown" value="4" />
            <Option text="Green" value="5" />
            <Option text="Orange" value="6" />
            <Option text="Pink" value="7" />
            <Option text="Purple" value="8" />
            <Option text="Red" value="9" />
            <Option text="White" value="10" />
            <Option text="Yellow" value="11" />
          </Select>
        </div>
      );
    }}
  </Story>
</Preview>

### With object as value:
Option values could be passed as objects. Useful when custom data is associated with an option.

<Preview>
  <Story name="with object as value" parameters={{ chromatic: { disable: true }}} >
    {() => {
      const [value, setValue] = useState({});
      const optionList = useRef([
        <Option text='Amber' key='Amber' value={ { value: 1, text: 'Amber' } } />,
        <Option text='Black' key='Black' value={ { value: 2, text: 'Black' } } />,
        <Option text='Blue' key='Blue' value={ { value: 3, text: 'Blue' } } />,
        <Option text='Brown' key='Brown' value={ { value: 4, text: 'Brown' } } />,
        <Option text='Green' key='Green' value={ { value: 5, text: 'Green' } } />,
        <Option text='Orange' key='Orange' value={ { value: 6, text: 'Orange' } } />,
        <Option text='Pink' key='Pink' value={ { value: 7, text: 'Pink' } } />,
        <Option text='Purple' key='Purple' value={ { value: 8, text: 'Purple' } } />,
        <Option text='Red' key='Red' value={ { value: 9, text: 'Red' } } />,
        <Option text='White' key='White' value={ { value: 10, text: 'White' } } />,
        <Option text='Yellow' key='Yellow' value={ { value: 11, text: 'Yellow' } } />
      ]);
      function onChangeHandler(event) {
        setValue(event.target.value);
      }
      function clearValue() {
        setValue({});
      }
      return (
        <div>
          <Button onClick={ clearValue } mb={ 2 }>clear</Button>
          <Select
            id='with-object'
            name='with-object'
            value={ value }
            onChange={ onChangeHandler }
          >
            { optionList.current }
          </Select>
        </div>
      );
    }}
  </Story>
</Preview>

### With isLoading prop:
When `isLoading` prop is passed, a loader will be appended at the end of the Select List. That functionality could be used to load the options asynchronously.

<Preview>
  <Story name="with isLoading prop" parameters={{ chromatic: { disable: true }}} > 
    {() => {
      let preventLoading = useRef(false);
      const [value, setValue] = useState('black');
      const [isOpen, setIsOpen] = useState(false);
      const [isLoading, setIsLoading] = useState(true);
      const asyncList = [
        <Option text='Amber' value='amber' key='Amber' />,
        <Option text='Black' value='black' key='Black' />,
        <Option text='Blue' value='blue' key='Blue' />,
        <Option text='Brown' value='brown' key='Brown' />,
        <Option text='Green' value='green' key='Green' />,
      ];
      const [optionList, setOptionList] = useState([<Option text='Black' value='black' key='Black' />]);
      function loadList() {
        if (preventLoading.current) {
          return;
        }
        preventLoading.current = true;
        setIsLoading(true);
        setTimeout(() => {
          setIsLoading(false);
          setOptionList(asyncList)
        }, 2000);
      }
      function clearData() {
        setOptionList([<Option text='Black' value='black' key='Black' />]);
        setValue('black');
        preventLoading.current = false;
      }
      return (
        <div>
          <Button onClick={ clearData } mb={ 2 }>reset</Button>
          <Select
            name='isLoading'
            id='isLoading'
            label='label'
            value={ value }
            onChange={ (event) => setValue(event.target.value) }
            onOpen={ () => loadList() }
            isLoading={ isLoading }
          >
            { optionList }
          </Select>
        </div>
      );
    }}
  </Story>
</Preview>

### Open on focus:

<Preview>
  <Story name="openOnFocus" parameters={{ chromatic: { disable: true } }}>
    <Select name="openOnFocus" id="openOnFocus" openOnFocus>
      <Option text="Amber" value="1" />
      <Option text="Black" value="2" />
      <Option text="Blue" value="3" />
      <Option text="Brown" value="4" />
      <Option text="Green" value="5" />
      <Option text="Orange" value="6" />
      <Option text="Pink" value="7" />
      <Option text="Purple" value="8" />
      <Option text="Red" value="9" />
      <Option text="White" value="10" />
      <Option text="Yellow" value="11" />
    </Select>
  </Story>
</Preview>

### Disabled:

<Preview>
  <Story name="disabled">
    <Select name="disabled" id="disabled" defaultValue="3" disabled>
      <Option text="Amber" value="1" />
      <Option text="Black" value="2" />
      <Option text="Blue" value="3" />
      <Option text="Brown" value="4" />
      <Option text="Green" value="5" />
      <Option text="Orange" value="6" />
      <Option text="Pink" value="7" />
      <Option text="Purple" value="8" />
      <Option text="Red" value="9" />
      <Option text="White" value="10" />
      <Option text="Yellow" value="11" />
    </Select>
  </Story>
</Preview>

### Read Only:

<Preview>
  <Story name="readonly">
    <Select name="readonly" id="readonly" defaultValue="4" readOnly>
      <Option text="Amber" value="1" />
      <Option text="Black" value="2" />
      <Option text="Blue" value="3" />
      <Option text="Brown" value="4" />
      <Option text="Green" value="5" />
      <Option text="Orange" value="6" />
      <Option text="Pink" value="7" />
      <Option text="Purple" value="8" />
      <Option text="Red" value="9" />
      <Option text="White" value="10" />
      <Option text="Yellow" value="11" />
    </Select>
  </Story>
</Preview>

### Transparent:

<Preview>
  <Story name="transparent">
    <Select name="transparent" id="transparent" defaultValue="4" transparent>
      <Option text="Amber" value="1" />
      <Option text="Black" value="2" />
      <Option text="Blue" value="3" />
      <Option text="Brown" value="4" />
      <Option text="Green" value="5" />
      <Option text="Orange" value="6" />
      <Option text="Pink" value="7" />
      <Option text="Purple" value="8" />
      <Option text="Red" value="9" />
      <Option text="White" value="10" />
      <Option text="Yellow" value="11" />
    </Select>
  </Story>
</Preview>

### With disabled portal:

<Preview>
  <Story
    name="withDisabledPortal"
    parameters={{ chromatic: { disable: true } }}
  >
    <Select
      name="withDisabledPortal"
      id="withDisabledPortal"
      defaultValue="4"
      disablePortal
    >
      <Option text="Amber" value="1" />
      <Option text="Black" value="2" />
      <Option text="Blue" value="3" />
      <Option text="Brown" value="4" />
      <Option text="Green" value="5" />
      <Option text="Orange" value="6" />
      <Option text="Pink" value="7" />
      <Option text="Purple" value="8" />
      <Option text="Red" value="9" />
      <Option text="White" value="10" />
      <Option text="Yellow" value="11" />
    </Select>
  </Story>
</Preview>

### Option groups:

<Preview>
  <Story name="option groups" parameters={{ chromatic: { disable: true } }}>
    <Select name="optGroups" id="optGroups">
      <OptionGroupHeader label="Group one" icon="individual" />
      <Option text="Amber" value="1" />
      <Option text="Black" value="2" />
      <Option text="Blue" value="3" />
      <Option text="Brown" value="4" />
      <OptionGroupHeader label="Group two" icon="shop" />
      <Option text="Green" value="5" />
      <Option text="Orange" value="6" />
      <Option text="Pink" value="7" />
      <OptionGroupHeader label="Group three" />
      <Option text="Purple" value="8" />
      <Option text="Red" value="9" />
      <Option text="White" value="10" />
      <Option text="Yellow" value="11" />
    </Select>
  </Story>
</Preview>

### Enabling the adaptive behaviour

The inline label can change to be top aligned at a breakpoint. Enable this by passing in a number to the `adaptiveLabelBreakpoint` prop. This corresponds to a px screen width

<Preview>
  <Story
    name="enabling adaptive behaviour"
    parameters={{ chromatic: { disable: true } }}
  >
    <Select
      name="adaptive"
      id="adaptive"
      label="label"
      defaultValue="4"
      adaptiveLabelBreakpoint={960}
    >
      <Option text="Amber" value="1" />
      <Option text="Black" value="2" />
      <Option text="Blue" value="3" />
      <Option text="Brown" value="4" />
      <Option text="Green" value="5" />
      <Option text="Orange" value="6" />
      <Option text="Pink" value="7" />
      <Option text="Purple" value="8" />
      <Option text="Red" value="9" />
      <Option text="White" value="10" />
      <Option text="Yellow" value="11" />
    </Select>
  </Story>
</Preview>

<StyledSystemProps of={Select} spacing />

## Props:

<Props of={Select} />

### Props derived from the Textbox Component

<Props of={SelectTextbox} />

### Props of the Option Component

<Props of={Option} />
