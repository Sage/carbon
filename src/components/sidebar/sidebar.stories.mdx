import { useState, useRef } from "react";
import { Meta, Story, Canvas } from "@storybook/addon-docs";
import StyledSystemProps from "../../../.storybook/utils/styled-system-props";

import Sidebar from ".";
import Button from "../button";
import Typography from "../typography";
import Form from "../form";
import Toast from "../toast";
import Textbox from "../textbox";
import TranslationKeysTable from "../../../.storybook/utils/translation-keys-table";

import isChromatic from "../../../.storybook/isChromatic";

export const isOpenForChromatic = isChromatic();

<Meta
  title="Sidebar"
  parameters={{
    info: { disable: true },
    themeProvider: { chromatic: { theme: "sage" } },
  }}
/>

# Sidebar

## Contents

- [Quick Start](#quick-start)
- [Designer Notes](#designer-notes)
- [Related Components](#related-components)
- [Examples](#examples)
- [Props](#props)

## Quick Start

```javascript
import Sidebar from "carbon-react/lib/components/sidebar";
```

## Designer Notes

Useful to perform an action in context without navigating the user to a separate page.

Useful if the user might need to refer back to the page behind the sidebar. For example, the user could select from a list of clients on the page, with detailed information on the client loading in the sidebar.

Several pre-set widths are available, and the height of the sidebar is always 100%. It’s best to avoid sidebars that are taller than the user’s viewport height, as a scroll would hide some information. Typical user viewport heights can be as little as 650 pixels.

Choose whether a dark tint is applied behind the dialog which helps to focus the user on the sidebar, but don’t select this option if the user needs to refer back to the underlying page.

Sidebar is positioned on the right hand screen of the window by default.
To position the sidebar on the left hand side pass `position='left'` to the component.

The background behind the sidebar is disabled by default. To allow the user to interact
with all the UI pass `enableBackgroundUI={ true }` to the component

## Related Components

- Simple task in context? [Try Dialog](/?path=/docs/dialog--default-story "Try Dialog").
- Complex task that needs more space? [Try Dialog Full Screen](/?path=/docs/dialog-full-screen--default-story "Try Dialog Full Screen").

## Examples

### Default

<Canvas>
  <Story name="default">
    {() => {
      const [isOpen, setIsOpen] = useState(isOpenForChromatic);
      return (
        <>
          <Button onClick={() => setIsOpen(true)}>Open sidebar</Button>
          <Sidebar
            aria-label="sidebar"
            open={isOpen}
            onCancel={() => setIsOpen(false)}
          >
            <div>
              <Button buttonType="primary">Test</Button>
              <Button buttonType="secondary" ml={2}>
                Last
              </Button>
            </div>
            Main Content
          </Sidebar>
        </>
      );
    }}
  </Story>
</Canvas>

### Custom padding around content

<Canvas>
  <Story name="custom padding around content">
    {() => {
      const [isOpen, setIsOpen] = useState(isOpenForChromatic);
      return (
        <>
          <Button onClick={() => setIsOpen(true)}>Open sidebar</Button>
          <Sidebar open={isOpen} onCancel={() => setIsOpen(false)} p={0}>
            <div>
              <Button buttonType="primary">Test</Button>
              <Button buttonType="secondary" ml={2}>
                Last
              </Button>
            </div>
            Main Content
          </Sidebar>
        </>
      );
    }}
  </Story>
</Canvas>

### With header

<Canvas>
  <Story name="with header">
    {() => {
      const [isOpen, setIsOpen] = useState(isOpenForChromatic);
      return (
        <>
          <Button onClick={() => setIsOpen(true)}>Open sidebar</Button>
          <Sidebar
            open={isOpen}
            onCancel={() => setIsOpen(false)}
            header={<Typography variant="h3">Sidebar header</Typography>}
          >
            <div>
              <Button buttonType="primary">Test</Button>
              <Button buttonType="secondary" ml={2}>
                Last
              </Button>
            </div>
            Main Content
          </Sidebar>
        </>
      );
    }}
  </Story>
</Canvas>

### With scroll

If sidebar content does not fit the sidebar, scroll will appear. Default scroll theme is "light".

<Canvas>
  <Story name="with scroll">
    {() => {
      const [isOpen, setIsOpen] = useState(isOpenForChromatic);
      return (
        <>
          <Button onClick={() => setIsOpen(true)}>Open sidebar</Button>
          <Sidebar
            open={isOpen}
            onCancel={() => setIsOpen(false)}
            header={<Typography variant="h3">Sidebar header</Typography>}
          >
            <div>
              <Button buttonType="primary">Test</Button>
              <Button buttonType="secondary" ml={2}>
                Last
              </Button>
            </div>
            <div style={{ marginBottom: 3000 }}>Long content</div>
          </Sidebar>
        </>
      );
    }}
  </Story>
</Canvas>

### With Typography

<Canvas>
  <Story name="with typography">
    {() => {
      const [isOpen, setIsOpen] = useState(isOpenForChromatic);
      return (
        <>
          <Button onClick={() => setIsOpen(true)}>Open sidebar</Button>
          <Sidebar
            aria-label="sidebar"
            position="left"
            open={isOpen}
            onCancel={() => setIsOpen(false)}
            header={<Typography variant="h3">Sidebar Header</Typography>}
          >
            <Form
              rightSideButtons={<Button>Action button</Button>}
              stickyFooter={true}
              buttonAlignment="right"
            >
              <Typography variant="p">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed
                lectus massa, suscipit vitae pellentesque quis, facilisis non
                ante. Curabitur fringilla sapien non ante elementum venenatis.
                Curabitur viverra, massa ac congue imperdiet, purus ligula
                dictum quam, id tincidunt diam risus quis eros. Vivamus semper
                sem ac tempor malesuada. Proin nec sollicitudin mi. Nunc egestas
                ipsum ac lorem pretium blandit. Quisque ac ultricies lacus.
                Phasellus vel enim id est ornare finibus eget vitae ipsum.
                Maecenas non accumsan dolor. Morbi sed mauris mollis lorem
                finibus feugiat. Maecenas scelerisque nec orci ac finibus. Nulla
                dictum, quam vel gravida lobortis, nisl eros vulputate augue,
                eget malesuada lacus elit sed leo. In a ex id metus vulputate
                sollicitudin at eget neque. Aliquam cursus quis odio in
                consequat.
              </Typography>
              <Typography variant="p">
                In a finibus tellus, non rutrum est. Nam sed cursus diam. Sed
                commodo metus laoreet, tristique velit in, scelerisque lectus.
                Nullam suscipit eu nulla vel porttitor. Donec aliquet faucibus
                nunc consequat feugiat. Donec libero arcu, consequat in laoreet
                eu, maximus a nunc. Sed tincidunt nisl vitae diam dapibus, eu
                varius ipsum vestibulum. Suspendisse auctor mattis turpis, in
                placerat nunc ornare vitae. Phasellus id ante a mi ultricies
                pellentesque. Donec laoreet lectus sit amet blandit varius. Orci
                varius natoque penatibus et magnis dis parturient montes,
                nascetur ridiculus mus. Nullam quis est tempus, posuere elit in,
                hendrerit risus.
              </Typography>
              <Typography variant="p">
                In ac nisi ante. Duis ut tellus lacus. Mauris vitae ultrices
                ipsum. Integer pretium non risus a convallis. Vivamus eu egestas
                magna, in blandit elit. In at efficitur urna. Quisque nec
                interdum nisi. Sed pharetra neque ac ipsum bibendum semper. Ut
                et egestas metus. Nullam nec porttitor turpis. Pellentesque a
                dapibus libero.
              </Typography>
              <Typography variant="p">
                Duis accumsan luctus risus. Ut eu nisi sed mi sodales sodales.
                Pellentesque habitant morbi tristique senectus et netus et
                malesuada fames ac turpis egestas. Etiam id turpis et diam
                varius sollicitudin quis ullamcorper orci. Vivamus et est eget
                ante pellentesque commodo. Sed sed lacus vitae arcu ullamcorper
                fermentum et in mauris. Fusce tempor tellus vitae nibh sodales
                hendrerit. Cras erat purus, feugiat vitae tellus in, iaculis
                aliquet elit. In nec neque tristique, faucibus dui a, fermentum
                ipsum. Vestibulum rutrum, augue eget bibendum mattis, purus
                augue commodo urna, nec porta mi turpis eget risus. Curabitur ut
                tincidunt tellus. Fusce vel elit bibendum, varius eros sit amet,
                convallis nisl. Nunc venenatis sed lacus at consectetur. Etiam
                tincidunt varius lorem. Aliquam finibus finibus rutrum.
              </Typography>
              <Typography variant="p">
                Nam augue urna, congue ac dictum vel, porttitor ac tortor.
                Phasellus in dictum sem, ut fringilla nibh. Vivamus efficitur
                tortor auctor augue aliquet ullamcorper. Aliquam et velit ut
                turpis tempor rutrum at et erat. Nam imperdiet sapien eros, a
                mollis felis tristique quis. Suspendisse sed ipsum sit amet eros
                scelerisque volutpat quis non libero. Vivamus non venenatis
                orci, at consequat leo. Suspendisse non turpis quis odio
                malesuada vehicula dignissim non est. Ut eu tortor at ligula
                venenatis porttitor. Vestibulum euismod felis et elementum
                luctus. Integer in libero at turpis sodales aliquam. Donec
                pellentesque metus sit amet lorem ullamcorper, ac ullamcorper
                odio tincidunt.
              </Typography>
            </Form>
          </Sidebar>
        </>
      );
    }}
  </Story>
</Canvas>

### Allowing other elements to be focused

Using the `focusableContainers` prop allows elements that are not DOM children of the Sidebar to be reachable with the keyboard while the Sidebar is open.
This may occasionally be useful with things like Toasts where they persist on the page until dismissed by clicking a close icon.
(In the example below, try clicking the cancel and/or save buttons and notice how you can navigate across one or both toasts as well as the sidebar using the keyboard.)

<Canvas>
  <Story
    name="other focusable containers"
    parameters={{ chromatic: { disable: true } }}
  >
    {() => {
      const [isDialogOpen, setIsDialogOpen] = useState(false);
      const [isToast1Open, setIsToast1Open] = useState(false);
      const [isToast2Open, setIsToast2Open] = useState(false);
      const toast1Ref = useRef(null);
      const toast2Ref = useRef(null);
      return (
        <>
          <Button onClick={() => setIsDialogOpen(true)}>Open sidebar</Button>
          <Sidebar
            open={isDialogOpen}
            onCancel={() => setIsDialogOpen(false)}
            header={<Typography variant="h3">Sidebar header</Typography>}
            focusableContainers={[toast1Ref, toast2Ref]}
          >
            <Form
              stickyFooter={true}
              height="500px"
              leftSideButtons={
                <Button onClick={() => setIsDialogOpen(false)}>Cancel</Button>
              }
              saveButton={
                <Button buttonType="primary" type="submit">
                  Save
                </Button>
              }
            >
              <Typography>
                This is an example of a dialog with a Form as content
              </Typography>
              <Textbox label="First Name" />
              <Textbox label="Middle Name" />
              <Textbox label="Surname" />
              <Button onClick={() => setIsToast1Open(true)}>
                Show first toast
              </Button>
              <Button
                ml={2}
                buttonType="primary"
                onClick={() => setIsToast2Open(true)}
              >
                Show second toast
              </Button>
            </Form>
          </Sidebar>
          <Toast
            open={isToast1Open}
            onDismiss={() => setIsToast1Open(false)}
            ref={toast1Ref}
            targetPortalId="stacked"
          >
            Toast message 1
          </Toast>
          <Toast
            open={isToast2Open}
            onDismiss={() => setIsToast2Open(false)}
            ref={toast2Ref}
            targetPortalId="stacked"
          >
            Toast message 2
          </Toast>
        </>
      );
    }}
  </Story>
</Canvas>

## Props

### Sidebar

<StyledSystemProps noHeader padding of={Sidebar} />

## Translation keys

The following keys are available to override the translations for this component by passing in a custom locale object to the
[i18nProvider](https://carbon.sage.com/?path=/story/documentation-i18n--page).

<TranslationKeysTable
  translationData={[
    {
      name: "sidebar.ariaLabels.close",
      description: "The text for close button aria-label attribute",
      type: "func",
      returnType: "string",
    },
  ]}
/>
