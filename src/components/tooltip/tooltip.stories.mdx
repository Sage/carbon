import { Meta, ArgsTable, Canvas, Story } from "@storybook/addon-docs";
import { useState, forwardRef } from "react";
import Tooltip from ".";
import Icon from "../icon";
import Button from "../button";
import Box from "../box";
import Switch from "../switch";
import { RadioButton, RadioButtonGroup } from "../radio-button";

<Meta
  title="Tooltip"
  parameters={{ info: { disable: true }, chromatic: { disable: true } }}
/>

# Tooltip

<a
  target="_blank"
  href="https://zeroheight.com/2ccf2b601/p/93ac95-tooltip"
  style={{ color: "#007E45", fontWeight: "bold", textDecoration: "underline" }}
>
  Product Design System component
</a>

The `Tooltip` component is built using `tippyjs` to support features such as dynamic positioning where the tooltip will
flip if there is no space in its default placement; and the arrow and tooltip will track the target element when a user scrolls
or the window resizes.

## Contents

- [Quick Start](#quick-start)
- [Examples](#examples)
- [Props](#props)

## Quick Start

```javascript
import Tooltip from "carbon-react/lib/components/tooltip";
```

## Examples

### Default

To use the Tooltip, pass in the component you want it to display on in via the `children` prop, any component passed in
must support `forwardRef`. By default the Tooltip does not need to be controlled and will display when the target element
is focused or hovered. The default `position` is "top" and `size` is "M". The `message` prop is the text displayed in the
tooltip and it and the `children` prop are required.

<Canvas>
  <Story name="default">
    {() => (
      <Box p="50px">
        <Tooltip message="I am a tooltip!">
          <Button onClick={() => {}}>Hover or focus me!</Button>
        </Tooltip>
      </Box>
    )}
  </Story>
</Canvas>

### Controlled

The Tooltip can also be controlled via the `isVisible` prop.

<Canvas>
  <Story name="controlled">
    {() => {
      const [isVisible, setIsVisible] = useState(false);
      return (
        <>
          <Switch
            mb="80px"
            label="Toggle tooltip visibility"
            name="toggle-tooltip-visibility"
            checked={isVisible}
            onChange={() => setIsVisible(!isVisible)}
          />
          <Tooltip message="I am a tooltip!" isVisible={isVisible}>
            <Button onClick={() => {}}>Target</Button>
          </Tooltip>
        </>
      );
    }}
  </Story>
</Canvas>

### Positioning

The Tooltip supports four `position`s: "top", "bottom", "left" and "right". However, if there is no room for it to display
in this position it will attempt to flip and dynamically place itself in the opposite position. The Tooltip will also track
the target element when a user scrolls. The flipping and tracking features can be seen by adjusting the window size
(ideally in the canvas tab) and scrolling.

<Canvas>
  <Story name="positioning">
    {() => {
      const [position, setPosition] = useState("top");
      return (
        <Box display="flex" justifyContent="center">
          <Box p="50px" display="flex" flexDirection="column">
            <RadioButtonGroup
              mb="80px"
              name="position-options"
              legend="Select the position for the target tooltip"
              value={position}
              onChange={(ev) => setPosition(ev.target.value)}
            >
              <RadioButton
                value="top"
                label="Top"
                checked={position === "top"}
              />
              <RadioButton
                value="bottom"
                label="Bottom"
                checked={position === "bottom"}
              />
              <RadioButton
                value="left"
                label="Left"
                checked={position === "left"}
              />
              <RadioButton
                value="right"
                label="Right"
                checked={position === "right"}
              />
            </RadioButtonGroup>
            <Tooltip message="I am a tooltip!" isVisible position={position}>
              <Button onClick={() => {}}>Target</Button>
            </Tooltip>
          </Box>
        </Box>
      );
    }}
  </Story>
</Canvas>

### Overriding the default flip behaviour

By default if there is no room for the Tooltip to display in the given position it will attempt to flip and dynamically
place itself in the opposite position. You can pass an array of `flipOverrides` which will alter the behaviour from the
default, the Tooltip will flip to the positions defined in the array in the order they are defined. The overriding
can be seen by adjusting the window size (ideally in the canvas tab) and scrolling. The example should render the
Tooltip "bottom" intitially, then flip to "right" when there is not enough room below, and finally to the "left" position
when there is no space to render to the right anymore.

<Canvas>
  <Story name="flip behaviour overrides">
    {() => {
      return (
        <Box p="50px">
          <Tooltip
            message="I am a tooltip!"
            isVisible
            position="bottom"
            flipOverrides={["right", "left"]}
          >
            <Button onClick={() => {}}>Target</Button>
          </Tooltip>
        </Box>
      );
    }}
  </Story>
</Canvas>

### Large tooltip

<Canvas>
  <Story name="large tooltip">
    {() => {
      return (
        <Box p="50px">
          <Tooltip message="I am a tooltip!" size="large">
            <Button onClick={() => {}}>Hover or focus me!</Button>
          </Tooltip>
        </Box>
      );
    }}
  </Story>
</Canvas>

### Types

The `Tooltip` can be rendered as two different `type`s which will alter the colour of the background: "error"
or if no value is passed it will default to a black background.

<Canvas>
  <Story name="types">
    {() => {
      const [isErrorTooltip, setIsErrorTooltip] = useState(false);
      return (
        <>
          <RadioButtonGroup
            mb="60px"
            name="type-options"
            legend="Select type of tooltip to render"
            value={isErrorTooltip ? "error" : "normal"}
            onChange={(ev) => setIsErrorTooltip(ev.target.value === "error")}
          >
            <RadioButton
              label="Normal tooltip"
              value="normal"
              checked={!isErrorTooltip}
            />
            <RadioButton
              label="Error tooltip"
              value="error"
              checked={isErrorTooltip}
            />
          </RadioButtonGroup>
          <Tooltip
            message="I am a tooltip!"
            type={isErrorTooltip ? "error" : undefined}
          >
            <Button onClick={() => {}}>Hover or focus me!</Button>
          </Tooltip>
        </>
      );
    }}
  </Story>
</Canvas>

### Color overrides

The `Tooltip` background and font color can be overridden via the `bgColor` and `fontColor` props and accept any valid
css value. Any values passed to the `bgColor` prop will override the color applied by the `type`

<Canvas>
  <Story name="color overrides">
    {() => {
      return (
        <Box p="50px">
          <Tooltip
            message="I am a tooltip!"
            bgColor="lightblue"
            fontColor="--colorsUtilityYin090"
          >
            <Button onClick={() => {}}>Hover or focus me!</Button>
          </Tooltip>
        </Box>
      );
    }}
  </Story>
</Canvas>

## Props

### Tooltip

<ArgsTable of={Tooltip} />
