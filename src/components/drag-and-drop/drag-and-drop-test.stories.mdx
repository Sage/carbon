import { useState } from "react";
import { Meta, Story, Preview } from "@storybook/addon-docs";
import { action } from "@storybook/addon-actions";

import { DraggableContext, WithDrag, WithDrop } from ".";
import { Table, TableHeader, TableRow, TableCell } from "../table";

<Meta
  title="DraggableContext/Test"
  parameters={{
    info: { disable: true },
    chromatic: {
      disable: true,
    },
  }}
  argTypes={{
    customDragLayer: { table: { disable: true } },
    onDrag: { table: { disable: true } },
    children: { table: { disable: true } },
  }}
/>

export const DraggableContextStory = ({ autoScroll }) => {
  const [state, setState] = useState([
    {
      id: "0",
      name: "UK",
    },
    {
      id: "1",
      name: "Germany",
    },
    {
      id: "2",
      name: "China",
    },
    {
      id: "3",
      name: "US",
    },
  ]);
  const handleDrag = (originalIndex, newIndex) => {
    const sortedItem = state[originalIndex];
    const newArr = [...state];
    newArr.splice(originalIndex, 1);
    newArr.splice(newIndex, 0, sortedItem);
    setState(newArr);
    action("drag")();
  };
  return (
    <DraggableContext onDrag={handleDrag} autoScroll={autoScroll}>
      <div>
        <Table tbody={false}>
          <thead>
            <TableRow as="header">
              <TableHeader />
              <TableHeader>Country</TableHeader>
            </TableRow>
          </thead>
          <tbody>
            {state.map((row, index) => (
              <TableRow key={row.id} uniqueID={row.id} index={index}>
                <TableCell>{row.name}</TableCell>
              </TableRow>
            ))}
          </tbody>
        </Table>
      </div>
    </DraggableContext>
  );
};

# Draggable Context

### Default

<Preview>
  <Story
    name="default"
    args={{
      autoScroll: true,
    }}
  >
    {DraggableContextStory.bind({})}
  </Story>
</Preview>
