language: node_js
node_js: node

cache:
  npm: true
  directories:
    - ~/.cache

addons:
   apt:
     packages:
       # Ubuntu 16+ does not install this dependency by default, so we need to install it ourselves
       - libgconf-2-4

stages:
  - test
  - regression
  - deploy

jobs:
  fast_finish: true
  include:
    - stage: test
      name: "lint"
      script: echo "Linting"
    - &cypress-travis-regression
      stage: regression
      script:
        - npm run storybook-ci </dev/null &>/dev/null &
        - wait-on http://localhost:9001
        - npm run cypress-travis-regression
      env: SUITE=accessibility/accessibility.feature
    - <<: *cypress-travis-regression
      env: SUITE=build/build.feature
    - <<: *cypress-travis-regression
      env: SUITE=build/buildClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/actionPopoverEvents.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/actionPopoverIFrame.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/actionPopoverIFrameClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/alert.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/alertClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/animatedMenuButton.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/appWrapper.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/buttonClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/buttonToggle.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/buttonToggleChangeIconPart1.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/buttonToggleChangeIconPart2.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/buttonToggleGroup.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/card.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/carouselClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/configurableItems.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/confirm.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/content.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/create.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/deprecated/checkbox.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/deprecated/dateInput.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/deprecated/dateRange.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/deprecated/decimalInput.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/deprecated/dropdown.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/deprecated/fieldset.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/deprecated/form.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/deprecated/groupedCharacter.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/deprecated/numberInput.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/deprecated/radioButton.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/deprecated/simpleColorPicker.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/deprecated/switch.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/deprecated/textarea.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/deprecated/textbox.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/detail.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/detailIconTypePart1.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/detailIconTypePart2.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/dialog.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/dialogFullScreen.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/draggableContext.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/checkbox.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/checkboxClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/dateInput.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/dateInputClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/dateRange.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/dateRangeClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/decimalInput.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/decimalInputClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/decimalPrecision.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/fieldset.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/fieldsetClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/form.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/formClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/groupedCharacter.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/groupedCharacterClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/numberInput.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/numberInputClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/select.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/selectClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/selectMultiple.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/textarea.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/textareaClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/textbox.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/textboxClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/experimental/textboxMultiple.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/filterComponent.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/flashClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/heading.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/help.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/i18nComponent.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/iconClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/iconTypePart1.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/iconTypePart2.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/inlineInputs.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/link.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/linkIconTypePart1.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/linkIconTypePart2.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/loader.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/menu.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/menuList.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/message.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/mountInApp.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/multiActionButtonClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/navigationBar.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/pagerClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/pages.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/pillClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/pod.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/portraitClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/preview.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/profileClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/radioButton/radioButtonMonthly.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/radioButton/radioButtonMonthlyClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/radioButton/radioButtonWeekly.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/radioButton/radioButtonWeeklyClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/radioButton/radioButtonYearly.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/radioButton/radioButtonYearlyClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/rainbow.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/row.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/settingsRow.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/showEditPodClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/sidebar.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/splitButtonClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/stepSequence.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/stepSequenceItem.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/tableAjax.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/tableAjaxClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/tableClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/tabs.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/tabsClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/tile.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/toastClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/validations/checkboxValidations.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/validations/checkboxValidationsClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/validations/dateInputValidations.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/validations/dateInputValidationsClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/validations/radioButtonValidations..feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/validations/radioButtonValidationsClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/validations/selectValidationClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/validations/selectValidations.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/validations/switchValidations.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/validations/switchValidationsClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/validations/textareaValidations.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/validations/textareaValidationsClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/validations/textboxValidations.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/validations/textboxValidationsClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/validations/validationsBasic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/validations/validationsBasicClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/validations/validationsTextboxBased.feature
    - <<: *cypress-travis-regression
      env: SUITE=regression/validations/validationsTextboxBasedClassic.feature
    - <<: *cypress-travis-regression
      env: SUITE=themes/themes.feature