language: node_js
node_js: node

addons:
   apt:
     packages:
       # Ubuntu 16+ does not install this dependency by default, so we need to install it ourselves
       - libgconf-2-4

stages:
  - test
  - regression
  - deploy

jobs:
  fast_finish: true
  include:
    - stage: test
      name: "lint"
      script: echo "Linting"
    - &cypress-travis-regression
      stage: regression
      script:
        - npm run storybook-ci </dev/null &>/dev/null &
        - wait-on http://localhost:9001
        - npm run cypress-travis-regression
      env: SUITE=alert
    - <<: *cypress-travis-regression
      env: SUITE=animatedMenuButton
    - <<: *cypress-travis-regression
      env: SUITE=appWrapper
    - <<: *cypress-travis-regression
      env: SUITE=buttonClassic
    - <<: *cypress-travis-regression
      env: SUITE=buttonToggle
    - <<: *cypress-travis-regression
      env: SUITE=buttonToggleChangeIconPart1
    - <<: *cypress-travis-regression
      env: SUITE=buttonToggleChangeIconPart2
    - <<: *cypress-travis-regression
      env: SUITE=buttonToggleGroup
    - <<: *cypress-travis-regression
      env: SUITE=card